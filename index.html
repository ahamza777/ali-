
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>ALI GENERAL STORE PRO v3</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
:root{--neon:#00e676;--dark:#020617;--glass:rgba(255,255,255,.08)}
*{margin:0;padding:0;box-sizing:border-box}
body{font-family:Segoe UI,sans-serif;background:linear-gradient(135deg,#0f172a,#020617);color:#fff;padding-bottom:140px}
header{position:sticky;top:0;background:rgba(27,94,32,.9);backdrop-filter:blur(10px);padding:16px;text-align:center;z-index:10}
.cart-count{position:absolute;right:18px;top:18px;background:red;padding:6px 12px;border-radius:50%;cursor:pointer;animation:pulse 1.5s infinite}
@keyframes pulse{0%{box-shadow:0 0 0 0 rgba(255,0,0,.6)}70%{box-shadow:0 0 0 18px rgba(255,0,0,0)}}

.filters{display:flex;gap:10px;padding:10px;background:#020617;overflow-x:auto}
.filters button{background:#1e293b;color:#fff;border:none;padding:8px 14px;border-radius:20px;cursor:pointer}
.filters button.active{background:var(--neon);color:#000}

.products{display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:20px;padding:20px}
.product{background:var(--glass);backdrop-filter:blur(12px);border-radius:18px;overflow:hidden;box-shadow:0 15px 40px rgba(0,0,0,.6);transition:.3s;position:relative}
.product:hover{transform:translateY(-12px) scale(1.05)}
.badge{position:absolute;top:10px;left:10px;background:#ff1744;padding:4px 10px;border-radius:20px;font-size:12px}
.product img{width:100%;height:160px;object-fit:cover}
.info{text-align:center;padding:12px}
.add-btn{background:var(--neon);color:#000;border:none;padding:10px 18px;border-radius:30px;font-weight:bold;cursor:pointer;transition:.2s}
.add-btn:hover{transform:scale(1.1)}

#cartPanel{position:fixed;right:-360px;top:0;width:340px;height:100%;background:rgba(15,23,42,.95);backdrop-filter:blur(14px);box-shadow:-6px 0 25px rgba(0,0,0,.7);padding:15px;transition:.5s cubic-bezier(.18,.89,.32,1.28);z-index:50}
#cartPanel.show{right:0}
.cart-item{display:flex;justify-content:space-between;margin:10px 0;font-size:14px}
.cart-item button{border:none;background:#1e293b;color:#fff;border-radius:6px;padding:2px 8px;cursor:pointer;transition:.2s}
.cart-item button:hover{transform:scale(1.2);background:var(--neon);color:#000}
.total{font-weight:bold;margin-top:10px}

#bottomBar{position:fixed;left:0;right:0;bottom:-120px;background:linear-gradient(90deg,#1b5e20,#00e676);color:#000;display:flex;justify-content:space-between;align-items:center;padding:14px 18px;transition:.4s;font-weight:800}
#bottomBar.show{bottom:0}

.modal{position:fixed;inset:0;background:rgba(0,0,0,.7);display:none;align-items:center;justify-content:center;z-index:200}
.modal .box{background:#020617;width:90%;max-width:520px;border-radius:18px;overflow:hidden;padding:15px;animation:pop .4s cubic-bezier(.34,1.56,.64,1)}
@keyframes pop{from{transform:scale(.7);opacity:0}}

.fly-img{position:fixed;z-index:9999;transition:all .8s cubic-bezier(.2,.8,.2,1)}

#adminPanel{position:fixed;left:-100%;top:0;width:100%;height:100%;background:#020617;z-index:300;padding:20px;overflow:auto;transition:.4s}
#adminPanel.show{left:0}

input,select,textarea{width:100%;padding:8px;margin:6px 0;border-radius:6px;border:none}
</style>
</head>
<body>
<header>
 <h2>ALI GENERAL STORE PRO v3</h2>
 <input id="searchInput" placeholder="Search..." style="width:90%;margin-top:10px;padding:10px;border-radius:10px;border:none">
 <div class="cart-count" id="cartCount">0</div>
</header>

<div class="filters">
 <button class="active" onclick="setCategory('all',this)">All</button>
 <button onclick="setCategory('grocery',this)">Grocery</button>
 <button onclick="setCategory('dairy',this)">Dairy</button>
 <button onclick="setCategory('snacks',this)">Snacks</button>
 <button onclick="setCategory('personal',this)">Personal Care</button>
 <button onclick="openAdmin()">Admin</button>
 <button onclick="openOrders()">Orders</button>
</div>

<section class="products" id="productList"></section>

<!-- CART -->
<div id="cartPanel">
 <h3>Your Cart</h3>
 <div id="cartItems"></div>
 <div class="total" id="cartTotal"></div>
 <button onclick="openCheckout()" style="margin-top:10px;width:100%">Checkout</button>
 <button id="closeCartBtn" style="margin-top:6px;background:#ff1744;color:#fff;border:none;padding:10px;width:100%">Close</button>
</div>

<div id="bottomBar">
 <div id="barText">0 items | ₹0</div>
 <button>View Cart</button>
</div>

<!-- CHECKOUT -->
<div class="modal" id="checkoutModal">
 <div class="box">
  <h2>Checkout</h2>
  <input id="custName" placeholder="Your Name">
  <input id="custPhone" placeholder="Phone">
  <textarea id="custAddress" placeholder="Address"></textarea>
  <p>GST (5%): ₹<span id="gstAmt">0</span></p>
  <p><b>Grand Total: ₹<span id="grandTotal">0</span></b></p>
  <button onclick="confirmOrder()" style="width:100%;background:var(--neon);color:#000;padding:10px;border:none">Confirm Order</button>
  <button onclick="closeCheckout()" style="width:100%;margin-top:6px">Cancel</button>
 </div>
</div>

<!-- INVOICE -->
<div class="modal" id="invoiceModal">
 <div class="box">
  <h2>Invoice</h2>
  <div id="invoiceContent"></div>
  <button onclick="printInvoice()" style="width:100%">Print</button>
  <button onclick="closeInvoice()" style="width:100%;margin-top:6px">Close</button>
 </div>
</div>

<!-- ORDER HISTORY -->
<div class="modal" id="ordersModal">
 <div class="box">
  <h2>Order History</h2>
  <div id="ordersList"></div>
  <button onclick="closeOrders()" style="width:100%;margin-top:6px">Close</button>
 </div>
</div>

<!-- ADMIN -->
<div id="adminPanel">
 <h2>Admin Panel</h2>
 <input id="adminName" placeholder="Product Name">
 <input id="adminPrice" type="number" placeholder="Price">
 <select id="adminCat">
  <option value="grocery">Grocery</option>
  <option value="dairy">Dairy</option>
  <option value="snacks">Snacks</option>
  <option value="personal">Personal Care</option>
 </select>
 <input id="adminImg" placeholder="Image URL">
 <input id="adminBadge" placeholder="Badge (HOT/NEW/SALE)">
 <button onclick="addAdminProduct()">Add Product</button>
 <button onclick="closeAdmin()" style="margin-top:10px">Close Admin</button>
</div>

<script>
let products=JSON.parse(localStorage.getItem('products'))||[
 {name:"Soap Powder",price:120,cat:"grocery",badge:"HOT",img:"https://images.unsplash.com/photo-1581579185169-7bfe75a5d3fa"},
 {name:"Shampoo",price:180,cat:"personal",badge:"SALE",img:"https://images.unsplash.com/photo-1607619056574-7b8d3ee536b2"},
 {name:"Milk Packet",price:60,cat:"dairy",badge:"NEW",img:"https://images.unsplash.com/photo-1585238342028-4bbc5e87fa19"},
 {name:"Chips",price:30,cat:"snacks",badge:"HOT",img:"https://images.unsplash.com/photo-1585238341986-5db0c38ab51c"},
 {name:"Biscuits",price:25,cat:"snacks",img:"https://images.unsplash.com/photo-1589987607891-9f1e2c6a0c5c"},
 {name:"Butter",price:110,cat:"dairy",img:"https://images.unsplash.com/photo-1589987607627-616cacd2d2f1"},
 {name:"Bread",price:45,cat:"grocery",img:"https://images.unsplash.com/photo-1549931319-a545dcf3bc73"},
 {name:"Toothpaste",price:95,cat:"personal",img:"https://images.unsplash.com/photo-1615484477778-ca3b77940c25"},
 {name:"Detergent Bar",price:20,cat:"grocery",badge:"SALE",img:"https://images.unsplash.com/photo-1581579185169-7bfe75a5d3fa"},
 {name:"Cold Drink",price:40,cat:"snacks",badge:"NEW",img:"https://images.unsplash.com/photo-1585238341986-5db0c38ab51c"}
];

let cart=JSON.parse(localStorage.getItem('cart')||'[]');
let orders=JSON.parse(localStorage.getItem('orders')||'[]');
let currentCat='all';

const list=productList,cartCountEl=cartCount;

function setCategory(c,btn){currentCat=c;document.querySelectorAll('.filters button').forEach(b=>b.classList.remove('active'));btn.classList.add('active');renderProducts();}

function renderProducts(){
 list.innerHTML='';
 products.filter(p=>(currentCat==='all'||p.cat===currentCat))
 .filter(p=>p.name.toLowerCase().includes(searchInput.value.toLowerCase()))
 .forEach(p=>{
  const d=document.createElement('div');
  d.className='product';
  d.innerHTML=`${p.badge?`<div class='badge'>${p.badge}</div>`:''}
   <img src='${p.img}'>
   <div class='info'><h4>${p.name}</h4><p>₹${p.price}</p><button class='add-btn'>Add</button></div>`;
  d.querySelector('button').onclick=(e)=>addToCart(p,e);
  list.appendChild(d);
 });
}

function flyToCart(imgEl){
 const img=imgEl.cloneNode();
 const r=imgEl.getBoundingClientRect();
 const cartR=cartCountEl.getBoundingClientRect();
 img.className='fly-img';
 img.style.left=r.left+'px';img.style.top=r.top+'px';img.style.width=r.width+'px';
 document.body.appendChild(img);
 setTimeout(()=>{img.style.left=cartR.left+'px';img.style.top=cartR.top+'px';img.style.width='20px';img.style.opacity='0.2';},10);
 setTimeout(()=>img.remove(),900);
}

function addToCart(p,e){const i=cart.find(x=>x.name===p.name);i?i.qty++:cart.push({...p,qty:1});if(e)flyToCart(e.target.closest('.product').querySelector('img'));saveCart();updateCart();}
function increaseQty(i){cart[i].qty++;saveCart();updateCart();}
function decreaseQty(i){if(cart[i].qty>1)cart[i].qty--;else cart.splice(i,1);saveCart();updateCart();}
function removeItem(i){cart.splice(i,1);saveCart();updateCart();}

function saveCart(){localStorage.setItem('cart',JSON.stringify(cart));}
function saveProducts(){localStorage.setItem('products',JSON.stringify(products));}
function saveOrders(){localStorage.setItem('orders',JSON.stringify(orders));}

function updateCart(){
 const items=cart.reduce((a,b)=>a+b.qty,0);
 const total=cart.reduce((a,b)=>a+b.qty*b.price,0);
 cartCountEl.innerText=items;
 barText.innerText=`${items} items | ₹${total}`;
 bottomBar.classList.toggle('show',items>0);
 renderCart();
}

function renderCart(){
 cartItems.innerHTML='';
 cart.forEach((i,idx)=>{
  cartItems.innerHTML+=`<div class='cart-item'>
   <span>${i.name}</span>
   <span>
    <button onclick='decreaseQty(${idx})'>-</button>
    <b>${i.qty}</b>
    <button onclick='increaseQty(${idx})'>+</button>
    ₹${i.qty*i.price}
    <button onclick='removeItem(${idx})'>✕</button>
   </span></div>`;
 });
 cartTotal.innerText='Total ₹'+cart.reduce((a,b)=>a+b.qty*b.price,0);
}

/* CHECKOUT + GST + ORDER */
function openCheckout(){
 const total=cart.reduce((a,b)=>a+b.qty*b.price,0);
 const gst=+(total*0.05).toFixed(2);
 gstAmt.innerText=gst;
 grandTotal.innerText=(total+gst).toFixed(2);
 checkoutModal.style.display='flex';
}
function closeCheckout(){checkoutModal.style.display='none';}

function confirmOrder(){
 const total=cart.reduce((a,b)=>a+b.qty*b.price,0);
 const gst=+(total*0.05).toFixed(2);
 const grand=+(total+gst).toFixed(2);
 const order={
  id:Date.now(),
  name:custName.value,
  phone:custPhone.value,
  address:custAddress.value,
  items:[...cart],
  total, gst, grand,
  date:new Date().toLocaleString()
 };
 orders.push(order); saveOrders();
 generateInvoice(order);
 sendWhatsApp(order);
 cart=[]; saveCart(); updateCart();
 closeCheckout();
}

function sendWhatsApp(order){
 let msg='ORDER INVOICE:%0A';
 order.items.forEach(i=>msg+=`${i.name} x ${i.qty} = ₹${i.qty*i.price}%0A`);
 msg+=`Subtotal: ₹${order.total}%0AGST: ₹${order.gst}%0AGrand Total: ₹${order.grand}%0AName: ${order.name}%0APhone: ${order.phone}%0AAddress: ${order.address}`;
 window.open(`https://wa.me/91XXXXXXXXXX?text=${msg}`,'_blank');
}

/* INVOICE */
function generateInvoice(order){
 let html=`<p><b>Invoice ID:</b> ${order.id}</p><p><b>Date:</b> ${order.date}</p>`;
 html+='<hr>';
 order.items.forEach(i=>{html+=`<p>${i.name} x ${i.qty} = ₹${i.qty*i.price}</p>`});
 html+=`<hr><p>Subtotal: ₹${order.total}</p><p>GST (5%): ₹${order.gst}</p><h3>Grand Total: ₹${order.grand}</h3>`;
 invoiceContent.innerHTML=html;
 invoiceModal.style.display='flex';
}
function printInvoice(){window.print();}
function closeInvoice(){invoiceModal.style.display='none';}

/* ORDER HISTORY */
function openOrders(){
 ordersList.innerHTML='';
 orders.slice().reverse().forEach(o=>{
  ordersList.innerHTML+=`<div style='border-bottom:1px solid #333;padding:6px'>
   <b>${o.date}</b><br>ID: ${o.id}<br>₹${o.grand}
  </div>`;
 });
 ordersModal.style.display='flex';
}
function closeOrders(){ordersModal.style.display='none';}

/* ADMIN */
function openAdmin(){adminPanel.classList.add('show');}
function closeAdmin(){adminPanel.classList.remove('show');}
function addAdminProduct(){
 products.push({name:adminName.value,price:+adminPrice.value,cat:adminCat.value,img:adminImg.value,badge:adminBadge.value});
 saveProducts();renderProducts();alert('Product Added');
}

cartCount.onclick=()=>cartPanel.classList.add('show');
bottomBar.onclick=()=>cartPanel.classList.add('show');
closeCartBtn.onclick=()=>cartPanel.classList.remove('show');
searchInput.oninput=renderProducts;

renderProducts();updateCart();
</script>
</body>
</html>
```

<!-- ORDER DETAILS PANEL (RESTORED) -->

<div id="orderDetails" class="order-details hidden">
  <h3>Order Details</h3>
  <div id="orderProductList"></div>
  <div id="orderSummary"></div>
</div>

<script>
// === RESTORED: CLICK ORDER -> SHOW PRODUCT INFORMATION ===
const orderDetails = document.getElementById('orderDetails');
const orderProductList = document.getElementById('orderProductList');
const orderSummary = document.getElementById('orderSummary');

function openOrderDetails(){
  orderProductList.innerHTML='';
  let total = 0;
  cart.forEach(p=>{
    const row = document.createElement('div');
    row.className='order-row';
    row.innerHTML = `<strong>${p.name}</strong> x ${p.qty} = ₹${p.qty*p.price}`;
    orderProductList.appendChild(row);
    total += p.qty*p.price;
  });
  orderSummary.innerHTML = `<hr><h4>Total: ₹${total}</h4>`;
  orderDetails.classList.remove('hidden');
}

// Attach to Checkout / Order button
const checkoutBtn = document.getElementById('checkoutBtn');
if(checkoutBtn){
  checkoutBtn.onclick = openOrderDetails;
}
</script>

<style>
.order-details{
  position:fixed;inset:0;background:rgba(0,0,0,.6);
  display:flex;flex-direction:column;align-items:center;justify-content:center;
  z-index:500;
}
.order-details.hidden{display:none}
.order-details>div, .order-details{
  background:rgba(255,255,255,.95);
  padding:20px;border-radius:16px;
  max-width:420px;width:90%;
}
.order-row{margin:6px 0}
</style>

